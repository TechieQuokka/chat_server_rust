# ============================================
# Chat Server v3 - Environment Variables
# ============================================
# Copy this file to .env and fill in the values

# ============================================
# Server Configuration
# ============================================
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
ENVIRONMENT=development

# ============================================
# Database Configuration (PostgreSQL 16)
# ============================================
DATABASE_URL=postgres://chat_user:chat_password@localhost:5432/chat_db
DATABASE_MAX_CONNECTIONS=20
DATABASE_MIN_CONNECTIONS=5
DATABASE_CONNECT_TIMEOUT_SECONDS=30
DATABASE_IDLE_TIMEOUT_SECONDS=600
DATABASE_MAX_LIFETIME_SECONDS=1800

# ============================================
# Redis Configuration (Redis 7)
# ============================================
REDIS_URL=redis://localhost:6379
REDIS_MAX_CONNECTIONS=10
REDIS_SESSION_TTL_SECONDS=86400
REDIS_CACHE_TTL_SECONDS=3600

# ============================================
# JWT Configuration
# ============================================
JWT_SECRET=your-super-secret-key-change-in-production-minimum-32-characters
JWT_ACCESS_TOKEN_EXPIRY_SECONDS=900
JWT_REFRESH_TOKEN_EXPIRY_SECONDS=604800
JWT_ISSUER=chat-server
JWT_AUDIENCE=chat-client

# ============================================
# Snowflake ID Generator
# ============================================
SNOWFLAKE_MACHINE_ID=1
SNOWFLAKE_NODE_ID=1

# ============================================
# Rate Limiting
# ============================================
RATE_LIMIT_REQUESTS_PER_SECOND=50
RATE_LIMIT_BURST_SIZE=100
RATE_LIMIT_MESSAGE_PER_SECOND=10
RATE_LIMIT_MESSAGE_BURST=20

# ============================================
# CORS Configuration
# ============================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_MAX_AGE_SECONDS=3600

# ============================================
# Observability
# ============================================
RUST_LOG=info,chat_server=debug,sqlx=warn,tower_http=debug
RUST_BACKTRACE=1

# Jaeger/OTLP Tracing
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=chat-server

# Prometheus Metrics
METRICS_PORT=9100

# ============================================
# Email Configuration (MailHog for dev)
# ============================================
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_ADDRESS=noreply@chat.local
SMTP_TLS_ENABLED=false

# ============================================
# File Upload
# ============================================
UPLOAD_MAX_SIZE_BYTES=10485760
UPLOAD_ALLOWED_TYPES=image/png,image/jpeg,image/gif,image/webp
UPLOAD_STORAGE_PATH=./uploads

# ============================================
# WebSocket Gateway
# ============================================
WS_HEARTBEAT_INTERVAL_MS=41250
WS_HEARTBEAT_TIMEOUT_MS=90000
WS_MAX_CONNECTIONS_PER_USER=5
WS_MAX_MESSAGE_SIZE_BYTES=4096
